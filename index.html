<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lucky Draw Registration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .card {
      background: #ffffff;
      padding: 24px 28px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      max-width: 460px;
      width: 90%;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 8px;
    }
    p {
      font-size: 0.95rem;
      line-height: 1.4;
      margin-top: 0;
      color: #444;
    }
    label {
      display: block;
      font-weight: 600;
      margin-top: 16px;
      margin-bottom: 6px;
      font-size: 0.9rem;
    }
    input[type="tel"] {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
      box-sizing: border-box;
    }
    button {
      margin-top: 16px;
      width: 100%;
      padding: 10px 12px;
      border-radius: 999px;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      background: #007bff;
      color: white;
    }
    button:hover { opacity: 0.9; }
    .small {
      font-size: 0.8rem;
      color: #777;
      margin-top: 6px;
    }
    .captured-box {
      margin-top: 22px;
      padding: 12px 12px 4px;
      border-radius: 10px;
      background: #f0f4ff;
      font-size: 0.9rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 0.85rem;
    }
    th, td {
      padding: 6px 4px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }
    th {
      font-weight: 600;
      color: #555;
    }
    .warning {
      margin-top: 16px;
      font-size: 0.85rem;
      color: #aa0000;
      font-weight: 600;
    }
    .demo-note {
      margin-top: 10px;
      font-size: 0.8rem;
      color: #888;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>Event Lucky Draw</h1>
    <p>Scan the QR code and enter your mobile number to confirm your entry.</p>

    <form id="phoneForm">
      <label for="phone">Mobile number</label>
      <input
        type="tel"
        id="phone"
        name="phone"
        placeholder="+65 9123 4567"
        required
      />
      <button type="submit">Confirm Entry</button>
      <div class="small">Standard data rates may apply.</div>
    </form>

    <div class="captured-box" id="capturedBox" style="display:none;">
      <strong>Captured numbers (this browser only):</strong>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Phone number</th>
            <th>Time</th>
          </tr>
        </thead>
        <tbody id="capturedTableBody">
        </tbody>
      </table>
    </div>

    <div class="warning">
      Demo explanation for your class:
      <br />
      “A real malicious site would silently save these numbers on its own server.
       Here we only store them in this browser to show what’s possible.”
    </div>

    <div class="demo-note">
      Training demo only: numbers are stored in this device’s browser
      (localStorage) and are not sent to any external server.
    </div>
  </div>

  <script>
    const STORAGE_KEY = "qrDemoCapturedNumbers";

    function loadNumbers() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch (e) {
        console.error("Error reading stored numbers", e);
        return [];
      }
    }

    function saveNumbers(numbers) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(numbers));
      } catch (e) {
        console.error("Error saving stored numbers", e);
      }
    }

    function renderTable() {
      const numbers = loadNumbers();
      const tbody = document.getElementById("capturedTableBody");
      const box = document.getElementById("capturedBox");

      if (!numbers.length) {
        box.style.display = "none";
        return;
      }

      box.style.display = "block";
      tbody.innerHTML = "";

      numbers.forEach((entry, index) => {
        const tr = document.createElement("tr");

        const tdIndex = document.createElement("td");
        tdIndex.textContent = index + 1;

        const tdPhone = document.createElement("td");
        tdPhone.textContent = entry.phone;

        const tdTime = document.createElement("td");
        tdTime.textContent = entry.time;

        tr.appendChild(tdIndex);
        tr.appendChild(tdPhone);
        tr.appendChild(tdTime);
        tbody.appendChild(tr);
      });
    }

    document.getElementById("phoneForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const phoneInput = document.getElementById("phone");
      const phone = phoneInput.value.trim();
      if (!phone) return;

      const now = new Date();
      const entry = {
        phone,
        time: now.toLocaleTimeString()
      };

      const numbers = loadNumbers();
      numbers.push(entry);
      saveNumbers(numbers);
      renderTable();

      console.log("Captured phone number (demo only, localStorage):", phone);
      phoneInput.value = "";
    });

    // Render any previously stored numbers when page loads
    renderTable();
  </script>
</body>
</html>
